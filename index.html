<html>
<head>
  <title>drape</title>
  <style>
    body {
      font-family: helvetica, arial;
      background-color: dimgray;
      margin:0px;
    }
    .fullscreen {
      position:absolute;
      top:0%;
      left:0%;
      width:100%;
      height:100%;
    }
  </style>
</head>
<body>
  <canvas id="canvas" class="fullscreen" style="width:100%; height:100%;"></canvas>
<script data-main="main" src="require.js">
/* TODO

x 3d canvas, basic webgl setup
x simple mesh triangulation of a heightmap function
x arcball viewing
 x view matrix
 x drag/touch to change angles
  x accumulate angles
x lighting and colours
o New plan
 o Height map becomes surface map with basis vectors and curvature.
 o Then take a sample grid and perturb it based on curvature and feature detection (and tool size/shape?)
 o Then generate vector field and join up into tool path.
 o Then triangulate toolpath to give renderable mesh.
! Return surface info at each 2D point, not just height:
x Rename height module
x Rename: tangent->cutDir, cotangent to perpDir
x Return basis and curvature for cube
x tests
x Visualise cut direction vector field
 x Add arrow heads
x Refactor out duplication in draw* modules
 x Shader loading etc
 x Buffer setup
 x Camera module
x Pinch to move camera in/out
 x touch module should export pan / pinch etc events directly (ie touch.pan not touch.start/move etc)
 x Proper multitouch handling
 x Pinch zoom
x Return basis and curvature for sphere
x Translate
x Sweep
 o Takes a profile and a path
 o For each point, find the line-of-profile
 x Height from profile evaluation on line-of-profile
 x CutDir from path
 x Perp from profile gives the normal
 x CutCurvature from profile
 x PerpCurvature from path
 x lerp needs to min/max. curvature hw/hh are wrong way round
x Numerical tests for normal and curvatures
 x Normal test
 x Fix ellipse normal
 x Curvature test
 x Fix ellipse curvature
 x Fix sphere cut curvature!
* Sweep takes another arg giving the scale of the profile along the path
 * Will mean redoing all the cutDir/curvature etc and it'll be a lot trickier :-/
* Refactor: generate grid of surface points and then triangulate/cutlines that
* Define an (initially uniform) sample grid
* Modify sweep to scale the profile along the path
 * Define the way the profile changes
 * Need to modify basis and curvature too
* Simple toolpath generation: simple criss/cross for now
* Triangulate from toolpath; generate cutlines visualisation from toolpath
* Generate tool path from surface info considered as a vector field
 * Property tests
* Modify mesh before toolpath generation: Coalesce samples that have low curvature
 * Property tests
* Add samples where curvature is high
 * Property tests
* Find discontinuities and increase sampling(?)
 * Property tests
* Two finger drag to pan

*/
</script>
</body>
</html>
